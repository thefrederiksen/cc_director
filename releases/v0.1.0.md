# CC Director v0.1.0 — Pre-Release

**Date:** 2026-02-09
**Status:** Working pre-release

## What Is CC Director

A WPF desktop application for managing multiple Claude Code CLI sessions from a single window. Each session runs in a borderless console overlay positioned over the WPF terminal area, with full native TUI rendering and keyboard input.

## Working Features

### Session Management
- Create multiple concurrent Claude Code sessions, each in its own embedded console
- Session list sidebar with color-coded activity indicators:
  - Green: Idle / Waiting for input
  - Blue: Working
  - Red: Waiting for permission
  - Gray: Starting / Exited
- Kill and close individual sessions
- Orphan process detection on startup

### Embedded Console Host
- Borderless overlay console window positioned over WPF terminal area
- Full Claude Code TUI rendering (colors, cursor, alternate screen buffer)
- Native keyboard input — click the console and type directly
- Z-order management with TOPMOST flash trick for reliable overlay behavior
- Console follows WPF window on move, resize, minimize/restore
- Static instance registry with cleanup on app exit

### Text Input (Two-Tier System)
- **Tier 1:** Unicode `WriteConsoleInput` — injects text via pure Unicode key events (VK=0), bypassing keyboard layout dependencies. Text and Enter sent in separate batches so Claude's TUI doesn't treat Enter as a newline in a paste.
- **Tier 2:** Clipboard paste fallback — saves clipboard, sets text, simulates Ctrl+V via `SendInput`, restores clipboard and WPF focus.

### Hook System & Pipe Messages
- All 14 Claude Code lifecycle hooks configured and routed
- Named pipe `CC_ClaudeDirector` for receiving hook events
- PowerShell relay script bridges Claude hooks stdin JSON to named pipe
- `EventRouter` maps Claude `session_id` to Director sessions
- Live pipe messages panel with color-coded event types (max 500 messages)
- Idempotent hook installation with backup and user content preservation

### Repository & Git Integration
- Repository registry via `appsettings.json`
- New Session dialog with repository picker and folder browse
- Git changes tab showing staged/unstaged changes with file-level color coding
  - Modified (amber), Added (green), Deleted (red), Renamed (blue), Untracked (gray)
- Polls repository every 5 seconds for real-time updates

### Core Infrastructure
- ConPTY terminal hosting with ANSI/VT100 rendering
- 2 MB circular terminal buffer (thread-safe ring buffer)
- Custom `DrawingVisual`-based terminal renderer with 50ms polling and 1000-line scrollback
- ANSI parser: SGR colors, cursor movement, scroll regions, alternate screen buffer, UTF-8
- Graceful process shutdown with Ctrl+C, fallback to kill

### Test Suite
- 53 xUnit tests covering buffer, pipe server, event router, hooks, activity state
- 1 known flaky test (`CreateSession_CmdExe_ReceivesOutput` — cmd.exe output timing)

## Known Issues & Limitations

### Scrolling
- Console scrollbar stripped (by design), but scroll buffer (conhost 9001 lines) is disconnected from Claude's alternate screen buffer
- Cannot scroll to end; over-scrolling shows empty space
- Keyboard scrolling (Page Up/Down) works natively

### UI Polish
- No session rename capability
- No configuration UI — requires manual `appsettings.json` editing
- No branch display in session sidebar
- No session grouping by repository

## Still To Do (Phase 1 Roadmap)

- Repository panel with repo names, current branch, active session count
- Session-to-repo association and sidebar grouping
- Permission prompt quick-reply buttons in the input bar
- VS Code-style pulsing activity indicators with tool name display
- Session history and auto-restart
- Settings dialog
- Multi-session operations (kill all, restart all)

## Phase 2 (Deferred)

- Web dashboard (React + xterm.js)
- Supabase real-time relay and session transcripts
- Multi-node Director management
- Authentication and authorization

## Environment

- **Framework:** .NET 10 (net10.0-windows)
- **Platform:** Windows only (ConPTY requirement)
- **Runtime:** win-x64
